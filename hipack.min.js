"use strict";(function(){function a(a){switch(a){case 9:case 10:case 13:case 32:return!0;default:return!1}}function b(a){switch(a){case 9:case 10:case 13:case 32:case 91:case 93:case 123:case 125:case 58:case 44:return!1;default:return!0}}function c(a){switch(a){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 97:case 65:case 98:case 66:case 99:case 67:case 100:case 68:case 101:case 69:case 102:case 70:return!0;default:return!1}}function d(a){switch(a){case 46:case 43:case 61:return!0;default:return c(a)}}function e(a){return a>48&&56>a}function f(a){switch(a){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:case 65:return 10;case 98:case 66:return 11;case 99:case 67:return 12;case 100:case 68:return 13;case 101:case 69:return 14;case 102:case 70:return 15}}var g=this,h=g.hipack,i={};i.noConflict=function(){return g.hipack=h,i};var j=(Object.prototype.hasOwnProperty,Object.keys),k=Array.isArray;i.DumpError=function(a){this.message=a,Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack},i.Dumper=function(a){this.indent=a?-1:0,this.output=""},i.Dumper.prototype.moreIndent=function(){this.indent>=0&&this.indent++},i.Dumper.prototype.lessIndent=function(){this.indent>0&&this.indent--},i.Dumper.prototype.dumpIndent=function(){for(var a=this.indent>=0?this.indent:0;a--;)this.output+="  "},i.Dumper.prototype.dumpString=function(a){this.output+='"';for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);switch(c){case 9:this.output+="\\t";break;case 10:this.output+="\\n";break;case 13:this.output+="\\r";break;case 34:this.output+='\\"';break;case 92:this.output+="\\\\";break;default:32>c?(this.output+="\\",16>c&&(this.output+="0"),this.output+=c.toString(16).toUpperCase()):this.output+=a.charAt(b)}}this.output+='"'},i.Dumper.prototype.dumpBoolean=function(a){this.output+=a?"True":"False"},i.Dumper.prototype.dumpNumber=function(a){this.output+=a.toString()},i.Dumper.prototype.dumpKeyVal=function(a,b){for(var c=0;c<b.length;c++){this.dumpIndent(),this.output+=b[c];var d=a[b[c]];"object"!=typeof d&&(this.output+=":"),this.indent>=0&&(this.output+=" "),this.dumpValue(d),this.indent>=0?this.output+="\n":c<b.length-1&&(this.output+=",")}},i.Dumper.prototype.dumpList=function(a){if(0==a.length)return void(this.output+="[]");this.output+="[",this.moreIndent(),this.indent>=0&&(this.output+="\n");for(var b=0;b<a.length;b++)this.dumpIndent(),this.dumpValue(a[b]),this.indent>=0?this.output+="\n":b<a.length-1&&(this.output+=",");this.lessIndent(),this.output+="]"},i.Dumper.prototype.dumpDict=function(a){var b=j(a);return 0==b.length?void(this.output+="{}"):(this.output+="{",this.moreIndent(),this.indent>=0&&(this.output+="\n"),this.dumpKeyVal(a,b.sort()),this.lessIndent(),this.dumpIndent(),void(this.output+="}"))},i.Dumper.prototype.dumpValue=function(a){var b=typeof a;switch(b){case"number":this.dumpNumber(a);break;case"boolean":this.dumpBoolean(a);break;case"string":this.dumpString(a);break;case"object":if(null!==a){k(a)?this.dumpList(a):this.dumpDict(a);break}b="null";default:throw new i.DumpError("Values of type '"+b+"' cannot be dumped")}},i.dump=function(a,b){var c=new i.Dumper(Boolean(b)),d=j(a);return c.dumpKeyVal(a,d.sort()),c.output};var l=-1,m=Number.parseInt,n=Number.parseFloat,o=String.fromCharCode;i.ParseError=function(a,b){this.message=b,this.position=a.pos,this.line=a.line,this.column=a.column,Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack},i.Parser=function(a){this.input=a,this.look=0,this.line=1,this.column=0,this.pos=0},i.Parser.prototype.nextCharCodeRaw=function(){if(this.pos>=this.input.length)return l;var a=this.input.charCodeAt(this.pos++);return 10==a&&(this.column=0,this.line++),this.column++,a},i.Parser.prototype.nextCharCode=function(){do if(this.look=this.nextCharCodeRaw(),35==this.look)for(;10!=this.look&&this.look!=l;)this.look=this.nextCharCodeRaw();while(this.look!=l&&35==this.look)},i.Parser.prototype.skipWhite=function(){for(;this.look!=l&&a(this.look);)this.nextCharCode()},i.Parser.prototype.matchCharCode=function(a,b){if(this.look!=a)throw void 0===b&&(b="Expected '"+o(a)+"', but '"+o(this.look)+"' was found instead"),new i.ParseError(this,message);this.nextCharCode()},i.Parser.prototype.parseKey=function(){for(var a=null;this.look!=l&&b(this.look);)null===a&&(a=""),a+=o(this.look),this.nextCharCode();if(null===a)throw new i.ParseError(parser,"key expected");return a},i.Parser.prototype.parseString=function(){var a="";for(this.matchCharCode(34);34!=this.look&&this.look!=l;){if(92==this.look)switch(this.look=this.nextCharCodeRaw()){case 34:this.look=34;break;case 110:this.look=10;break;case 114:this.look=13;break;case 116:this.look=9;break;case 92:this.look=92;break;default:var b=this.nextCharCodeRaw();if(!c(b)||!c(this.look))throw new i.ParseError(this,"invalid escape sequence");this.look=16*f(this.look)+f(b)}a+=o(this.look),this.look=this.nextCharCodeRaw()}return this.matchCharCode(34),a},i.Parser.prototype.parseList=function(){this.matchCharCode(91),this.skipWhite();for(var b=[];93!=this.look;){b.push(this.parseValue());var c=a(this.look);if(this.skipWhite(),44==this.look)this.nextCharCode();else if(!c&&!a(this.look))break;this.skipWhite()}return this.matchCharCode(93),b},i.Parser.prototype.parseDict=function(){this.matchCharCode(123),this.skipWhite();var a=this.parseKeyValItems(125);return this.matchCharCode(125),a},i.Parser.prototype.parseBoolean=function(){if(84==this.look||116==this.look)return this.nextCharCode(),this.matchCharCode(114),this.matchCharCode(117),this.matchCharCode(101),!0;if(this.look=70)return this.nextCharCode(),this.matchCharCode(97),this.matchCharCode(108),this.matchCharCode(115),this.matchCharCode(101),!1;throw new i.ParseError(this,"boolean value expected")},i.Parser.prototype.parseNumber=function(){var a="",b=!1;(43==this.look||45==this.look)&&(a+=o(this.look),this.nextCharCode(),b=!0);var c=!1,f=!1;48==this.look&&(a+="0",this.nextCharCode(),88==this.look||120==this.look?(a+=o(this.look),this.nextCharCode(),f=!0):e(this.look)&&(c=!0));for(var g=!1,h=!1;this.look!=l&&d(this.look);)if(f||69!=this.look&&101!=this.look){if(46==this.look){if(g||f||c)throw new i.ParseError(this,"invalid number");g=!0}if(43==this.look||45==this.look)throw new i.ParseError(this,"invalid number");a+=o(this.look),this.nextCharCode()}else{if(h)throw new i.ParseError(this,"invalid number");a+="e",h=!0,this.nextCharCode(),(43==this.look||45==this.look)&&(a+=o(this.look),this.nextCharCode())}if(0==a.length)throw new i.ParseError(this,"number expected");if(f){if(h||g)throw new i.ParseError(this,"invalid hex number");return m(a,16)}if(c){if(h||g)throw new i.ParseError(this,"invalid octal number");return m(a,8)}return g||h?n(a):m(a,10)},i.Parser.prototype.parseValue=function(){switch(this.look){case 34:return this.parseString();case 91:return this.parseList();case 123:return this.parseDict();case 84:case 116:case 70:case 102:return this.parseBoolean();default:return this.parseNumber()}},i.Parser.prototype.parseKeyValItems=function(b){for(var c={};this.look!=b;){var d=this.parseKey(),e=!1;switch(a(this.look)&&(e=!0,this.skipWhite()),this.look){case 58:this.nextCharCode(),this.skipWhite();case 123:case 91:e=!0}if(!e)throw new i.ParseError(this,"missing separator");if(c[d]=this.parseValue(),44==this.look)this.nextCharCode();else if(this.look!=b&&!a(this.look))break;this.skipWhite()}return c},i.Parser.prototype.parseMessage=function(){this.nextCharCode(),this.skipWhite();var a=null;return 123==this.look?(this.nextCharCode(),this.skipWhite(),a=this.parseKeyValItems(125),this.matchCharCode(125,"unterminated message, '}' expected")):a=this.parseKeyValItems(l),a},i.load=function(a){return new i.Parser(String(a)).parseMessage()},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.hipack=i):g.hipack=i}).call(this);